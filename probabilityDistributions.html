
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Probability Distributions &#8212; Statistical Methods and Data Analysis Techniques</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Measurements uncertainties" href="errors.html" />
    <link rel="prev" title="Probability" href="probability.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Methods and Data Analysis Techniques</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="preface.html">
   Preface
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="introduction.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="probability.html">
   Probability
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Probability Distributions
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="errors.html">
   Measurements uncertainties
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="interactive-nbs/ErrorMatrix.html">
     Interactive Example - Error Matrix
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="monteCarlo.html">
   Monte Carlo methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="inference.html">
   Statistical inference
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="likelihood.html">
   Parameter Estimation - Likelihood
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="interactive-nbs/MLMethod.html">
     Interactive Example - ML Method: Mean of a Gaussian
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="leastSquares.html">
   Parameter Estimation - Least Squares
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hypothesisTesting.html">
   Hypotheses Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="confidenceIntervals.html">
   Confidence Intervals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mva.html">
   Multivariate Analysis Methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="unfolding.html">
   Unfolding {#ch:Unfolding}
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/probabilityDistributions.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/maxgalli/hep-datanalysis-jb/test?urlpath=tree/book/probabilityDistributions.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#basic-combinatorics">
   Basic combinatorics
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#permutations-with-repetitions">
     Permutations with repetitions:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#permutations-without-repetitions">
     Permutations without repetitions:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#combinations-without-repetitions">
     Combinations without repetitions:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#combinations-with-repetitions">
     Combinations with repetitions:
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#discrete-distributions">
   Discrete Distributions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bernoulli-trials">
     Bernoulli trials
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#binomial">
     Binomial
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#multinomial-distribution">
     Multinomial Distribution
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#poisson-distribution">
     Poisson Distribution
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#continuous-distributions">
   Continuous Distributions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#uniform-distribution">
     Uniform Distribution
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gaussian-or-normal-distribution">
     Gaussian or Normal Distribution
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#chi-2-distribution">
     <span class="math notranslate nohighlight">
      \(\chi^2\)
     </span>
     Distribution
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#log-normal-distribution">
     Log-Normal Distribution
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exponential-distribution">
     Exponential Distribution
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gamma-distribution">
     Gamma Distribution
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#student-s-t-distribution">
     Student’s
     <span class="math notranslate nohighlight">
      \(t\)
     </span>
     -distribution
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#f-distribution">
     <span class="math notranslate nohighlight">
      \(F\)
     </span>
     -distribution
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#weibull-distribution">
     Weibull Distribution
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cauchy-breit-wigner-distribution">
     Cauchy (Breit-Wigner) Distribution
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#landau-distribution">
     Landau Distribution
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#crystal-ball">
     Crystal Ball
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#characteristic-function">
   Characteristic Function
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-central-limit-theorem">
   The Central Limit Theorem
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Probability Distributions</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#basic-combinatorics">
   Basic combinatorics
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#permutations-with-repetitions">
     Permutations with repetitions:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#permutations-without-repetitions">
     Permutations without repetitions:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#combinations-without-repetitions">
     Combinations without repetitions:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#combinations-with-repetitions">
     Combinations with repetitions:
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#discrete-distributions">
   Discrete Distributions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bernoulli-trials">
     Bernoulli trials
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#binomial">
     Binomial
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#multinomial-distribution">
     Multinomial Distribution
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#poisson-distribution">
     Poisson Distribution
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#continuous-distributions">
   Continuous Distributions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#uniform-distribution">
     Uniform Distribution
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gaussian-or-normal-distribution">
     Gaussian or Normal Distribution
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#chi-2-distribution">
     <span class="math notranslate nohighlight">
      \(\chi^2\)
     </span>
     Distribution
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#log-normal-distribution">
     Log-Normal Distribution
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exponential-distribution">
     Exponential Distribution
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gamma-distribution">
     Gamma Distribution
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#student-s-t-distribution">
     Student’s
     <span class="math notranslate nohighlight">
      \(t\)
     </span>
     -distribution
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#f-distribution">
     <span class="math notranslate nohighlight">
      \(F\)
     </span>
     -distribution
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#weibull-distribution">
     Weibull Distribution
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cauchy-breit-wigner-distribution">
     Cauchy (Breit-Wigner) Distribution
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#landau-distribution">
     Landau Distribution
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#crystal-ball">
     Crystal Ball
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#characteristic-function">
   Characteristic Function
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-central-limit-theorem">
   The Central Limit Theorem
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="probability-distributions">
<h1>Probability Distributions<a class="headerlink" href="#probability-distributions" title="Permalink to this headline">¶</a></h1>
<p>In this chapter we will describe the most common discrete and continuous
probability distribution functions encountered in physics.</p>
<div class="section" id="basic-combinatorics">
<h2>Basic combinatorics<a class="headerlink" href="#basic-combinatorics" title="Permalink to this headline">¶</a></h2>
<p>Let’s start with some nomenclature and some basic results from combinatorics that will be needed for what follows.</p>
<p>Typically we will be talking about sequences of objects: a distinction
has to be made on whether we care or not about the order of the elements
in a sequence. If we care about the order we talk about
<strong>permutations</strong>, otherwise we talk about <strong>combinations</strong> (permutations
are ordered combinations).</p>
<div class="tip admonition">
<p class="admonition-title">Example:</p>
<p>take the set of letters <span class="math notranslate nohighlight">\(\{abc\}\)</span>. The sequences <span class="math notranslate nohighlight">\(\{cab\}\)</span>
and <span class="math notranslate nohighlight">\(\{bac\}\)</span> are considered equivalent combinations but distinct
permutations.</p>
</div>
<div class="section" id="permutations-with-repetitions">
<h3>Permutations with repetitions:<a class="headerlink" href="#permutations-with-repetitions" title="Permalink to this headline">¶</a></h3>
<p>pick r objects from a set of n and put them back each time. The number
of permutations (ordered sequences) is:</p>
<p><span class="math notranslate nohighlight">\(n^r\)</span></p>
<div class="tip admonition">
<p class="admonition-title">Example:</p>
<p>A byte is a
sequence of 8 bits (0/1): the number of permutations with repetitions is
<span class="math notranslate nohighlight">\(2^8 = 256\)</span>. A lock with three digits (form 0 to 9) has <span class="math notranslate nohighlight">\(10^3\)</span>
permutations.</p>
</div>
</div>
<div class="section" id="permutations-without-repetitions">
<h3>Permutations without repetitions:<a class="headerlink" href="#permutations-without-repetitions" title="Permalink to this headline">¶</a></h3>
<p>pick r objects from a set of n and don’t put them back. At each pick you
will have one less object to choose from, so the number number of
permutations is reduced with respect to <span class="math notranslate nohighlight">\(n^r\)</span> (permutations with
repetitions). The number of permutations (ordered sequences) is:</p>
<p><span class="math notranslate nohighlight">\(\frac{n!}{(n-r)!}\)</span></p>
<div class="tip admonition">
<p class="admonition-title">Example:</p>
<p>take all permutations without
repetitions of the 52 cards in the deck: 52! (first pick you choose
among 52 cards, second pick among 51 etc…). Take all permutations of
the first 4 picks in a deck of 52 cards:
<span class="math notranslate nohighlight">\(52\cdot51\cdot50\cdot49 = 52!/ (52-4)!\)</span> (first you pick from 52, then
from 51, then from 50, then form 49).</p>
</div>
</div>
<div class="section" id="combinations-without-repetitions">
<h3>Combinations without repetitions:<a class="headerlink" href="#combinations-without-repetitions" title="Permalink to this headline">¶</a></h3>
<p>pick r objects from a set of n and don’t put them back. At each pick you
will have less objects to choose from as for permutations, but this time
all sequences that differ only by their order are considered to be the
same. The number of combinations (non-ordered sequences) is the number
of permutations corrected by the factor that describes the number of
ordered sequences (i.e. r!):</p>
<p><span class="math notranslate nohighlight">\(\frac{n!}{(n-r)!}\frac{1}{r!} = \binom{n}{r}\)</span></p>
<p>These numbers are the
so-called binomial coefficients, which appear in the binomial theorem:</p>
<p><span class="math notranslate nohighlight">\((p+q)^n=\sum_{r=0}^{n}{n\choose r}\, p^r\cdot q^{n-r}\)</span></p>
<p>An interesting
propertiy is that the number of combinations extracting r objects from n
or (n-r) from n is the same.</p>
<div class="tip admonition">
<p class="admonition-title">Example:</p>
<p>“lotto” (six-numbers lottery game): 6 numbers are extracted
(without putting them back) from a set of 90. The order of the
extraction is irrelevant. The probability to win (when all tickets are
sold) is <span class="math notranslate nohighlight">\(1/\binom{90}{6}\)</span> =1.6 <span class="math notranslate nohighlight">\(10^{-9}\)</span>.</p>
</div>
</div>
<div class="section" id="combinations-with-repetitions">
<h3>Combinations with repetitions:<a class="headerlink" href="#combinations-with-repetitions" title="Permalink to this headline">¶</a></h3>
<p>pick r objects from a set of n and put them back. As in the case of
permutations with repetition but this time without considering the
order.</p>
<p><span class="math notranslate nohighlight">\(\frac{(n+r-1)!}{(n-1)!r!} =  \binom{n+r-1}{r}\)</span></p>
<div class="tip admonition">
<p class="admonition-title">Example:</p>
<p>take r-scoops from n-icecream flavours. You can take them all the same
or repeat them as you like (assuming there is enough icecream…).</p>
</div>
<p>Derivation:</p>
<p>Start from an example: take 3 objects from a set of 5 (a,b,c,d,e).
Examples of those sequences are (a a b),<span class="math notranslate nohighlight">\(\;\)</span> (a b c),<span class="math notranslate nohighlight">\(\;\)</span> (c c c).
Now think about the sequences as ordered boxes filled with the letters:
one box for the a’s, one box for the b’s, etc… I will use a separator
“<span class="math notranslate nohighlight">\(|\)</span>” instead of drawing boxes (this trick will become very important in
a second):<br />
(a a b) <span class="math notranslate nohighlight">\(\rightarrow\)</span> a a <span class="math notranslate nohighlight">\(|\)</span> b <span class="math notranslate nohighlight">\(|\)</span> <span class="math notranslate nohighlight">\(\;\)</span> <span class="math notranslate nohighlight">\(|\)</span> <span class="math notranslate nohighlight">\(\;\)</span> <span class="math notranslate nohighlight">\(|\)</span> (the last three
are empty boxes corresponding to c, d, e)<br />
(a b c) <span class="math notranslate nohighlight">\(\rightarrow\)</span> a <span class="math notranslate nohighlight">\(|\)</span> b <span class="math notranslate nohighlight">\(|\)</span> c <span class="math notranslate nohighlight">\(|\)</span> <span class="math notranslate nohighlight">\(\;\)</span> <span class="math notranslate nohighlight">\(|\)</span> <span class="math notranslate nohighlight">\(\;\)</span><br />
(c c c) <span class="math notranslate nohighlight">\(\rightarrow\)</span> <span class="math notranslate nohighlight">\(\;\)</span><span class="math notranslate nohighlight">\(|\)</span> <span class="math notranslate nohighlight">\(\;\)</span> <span class="math notranslate nohighlight">\(|\)</span> c c c <span class="math notranslate nohighlight">\(|\)</span> <span class="math notranslate nohighlight">\(\;\)</span> <span class="math notranslate nohighlight">\(|\)</span><br />
We can also drop the letters and replace them with “x”, the position of
the box already tells which letter it correspnds to.<br />
e.g.: aab <span class="math notranslate nohighlight">\(\rightarrow\)</span> a a <span class="math notranslate nohighlight">\(|\)</span> b <span class="math notranslate nohighlight">\(|\)</span> <span class="math notranslate nohighlight">\(\;\)</span> <span class="math notranslate nohighlight">\(|\)</span> <span class="math notranslate nohighlight">\(\;\)</span> <span class="math notranslate nohighlight">\(|\)</span> <span class="math notranslate nohighlight">\(\rightarrow\)</span> x
x <span class="math notranslate nohighlight">\(|\)</span> x <span class="math notranslate nohighlight">\(|\)</span> <span class="math notranslate nohighlight">\(\;\)</span> <span class="math notranslate nohighlight">\(|\)</span> <span class="math notranslate nohighlight">\(\;\)</span> <span class="math notranslate nohighlight">\(|\)</span><br />
Considering “x” and “<span class="math notranslate nohighlight">\(|\)</span>” as objects (here is where the trick becomes
important), we can rephrase the problem as “in how many ways we can
place r = 3 “x” and n = 5-1 = 4 “<span class="math notranslate nohighlight">\(|\)</span>”.
This is the same as the combination w/o repetition “N pick R”, where in
this case:</p>
<p>N = n-1 + r (sum of all “<span class="math notranslate nohighlight">\(|\)</span>” and “x”)
R = r
<span class="math notranslate nohighlight">\(\;\;\;\;\;\Rightarrow\binom{n-1+r}{r}\)</span></p>
<p><a class="reference external" href="https://www.mathsisfun.com/combinatorics/combinations-permutations.html">Derivation reference</a></p>
<p>For large <span class="math notranslate nohighlight">\(n\)</span>, the <em>Stirling formula</em> can be used to approximate <span class="math notranslate nohighlight">\(n!\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
n! &amp; \approx &amp; \left(\frac{n}{e}\right)^n\sqrt{2\pi n}\\
\ln n! &amp; \approx &amp;  (n+1/2)\ln n-n+ln\sqrt{2\pi}
\end{split}\]</div>
<p>The first term in the second line, <span class="math notranslate nohighlight">\((n/e)^{n}\)</span>, is called the zero-th
approximation, whereas the whole term in the above equation is the first
approximation. The factorial <span class="math notranslate nohighlight">\(n!\)</span> can be extended for non-integer
arguments <span class="math notranslate nohighlight">\(x\)</span> by the gamma function <span class="math notranslate nohighlight">\(\Gamma(x)\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
x!&amp;=&amp;\int_0^\infty u^xe^{-u}du=\Gamma(x+1)\\
\Gamma(x+1)&amp;=&amp;x\Gamma(x)
\end{aligned}
\end{split}\]</div>
</div>
</div>
<div class="section" id="discrete-distributions">
<h2>Discrete Distributions<a class="headerlink" href="#discrete-distributions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="bernoulli-trials">
<h3>Bernoulli trials<a class="headerlink" href="#bernoulli-trials" title="Permalink to this headline">¶</a></h3>
<p>A <em>Bernoulli trial</em> is an experiment with only two outcomes
(success/failure or 1/0) and where success will occur with constant
probability <span class="math notranslate nohighlight">\(p\)</span> and failure with constant probability <span class="math notranslate nohighlight">\(q=1-p\)</span>. Examples
are again the coin toss, or (from particle physics) the decay of <span class="math notranslate nohighlight">\(K^{+}\)</span> into either
<span class="math notranslate nohighlight">\(\mu^{+}\nu\)</span> or any other channels. The random variable <span class="math notranslate nohighlight">\(r\in\{0,1\}\)</span> is
the outcome of the experiment and its p.d.f. is:</p>
<div class="math notranslate nohighlight">
\[
f(r;p) = p^r~q^{(1-r)}
\]</div>
<p>The p.d.f. is simply the probability for a single experiment to give success/failure.
The first two moments of the distribution are:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\mu = p \\
V(r) = p(1-p)
\end{split}\]</div>
<p>The distribution for a given value of p is:</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;font.size&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
        <span class="s2">&quot;lines.linewidth&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Bernoulli trials for a fixed p = 0.3 and 1000 trials</span>

<span class="n">r</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">p</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Events&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/probabilityDistributions_7_0.png" src="_images/probabilityDistributions_7_0.png" />
</div>
</div>
</div>
<div class="section" id="binomial">
<h3>Binomial<a class="headerlink" href="#binomial" title="Permalink to this headline">¶</a></h3>
<p>Given <span class="math notranslate nohighlight">\(n\)</span> Bernoulli trials with a probability of success <span class="math notranslate nohighlight">\(p\)</span>, the
binomial distribution gives the probability to observe <span class="math notranslate nohighlight">\(r\)</span> successes
and, consequently, <span class="math notranslate nohighlight">\(n-r\)</span> failures independently of the order with which
they appear. The random variable is again <span class="math notranslate nohighlight">\(r\)</span> but this time
<span class="math notranslate nohighlight">\(r\in\{0,n\}\)</span>, i.e. the maximum is given when all trials give a success.
The p.d.f. is:</p>
<div class="math notranslate nohighlight" id="equation-binomial">
<span class="eqno">(2)<a class="headerlink" href="#equation-binomial" title="Permalink to this equation">¶</a></span>\[P(r;n,p)={n\choose r}\, p^r(1-p)^{n-r}.\]</div>
<p>Eq.<a class="reference internal" href="#equation-binomial">(2)</a> can be motivated in the following way: the probability that we get a
positive outcome in the first <span class="math notranslate nohighlight">\(r\)</span> attempts and negative outcome in the
last <span class="math notranslate nohighlight">\(n-r\)</span> attempts, is given by <span class="math notranslate nohighlight">\(p^{r} \cdot (1-p)^{n-r}\)</span>; but this
sequential arrangement is only one of a total of <span class="math notranslate nohighlight">\({n \choose r}\)</span>
possible arrangements. The distribution for different values of the
parameters is plotted below.</p>
<p>p = 0.4
n = [2, 5, 10, 30]
repetitions = 10000</p>
<p>fig, ax = plt.subplots(1, len(n), figsize=(20, 6))
for i, N in enumerate(n):
samples = np.random.binomial(N, p, repetitions)
ax[i].hist(samples, bins=20, density=True);
ax[i].set_xlim(-1, N+1)
ax[i].set_title(‘n = {}’.format(N))
ax[i].set_xlabel(‘r’)
ax[i].set_ylabel(r’P(x=r)’)
plt.tight_layout()</p>
<p>The important properties of the binomial distribution are:</p>
<ul class="simple">
<li><p>It is normalized to 1, i.e. <span class="math notranslate nohighlight">\(\sum_{r=0}^n P(r)=1.\)</span></p></li>
<li><p>The mean of <span class="math notranslate nohighlight">\(r\)</span> is <span class="math notranslate nohighlight">\(&lt;r&gt;=\sum_{r=0}^n r\cdot P(r)=np.\)</span></p></li>
<li><p>The variance of <span class="math notranslate nohighlight">\(r\)</span> is <span class="math notranslate nohighlight">\(V(r)=np(1-p).\)</span></p></li>
</ul>
<p>The binomial distribution (like several others we will encounter) has
the <strong>reproductive property</strong>. If <span class="math notranslate nohighlight">\(X\)</span> is binomially distributed as
<span class="math notranslate nohighlight">\(P(X;n,p)\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> is binomially distributed (with the same probability
<span class="math notranslate nohighlight">\(p\)</span>) as <span class="math notranslate nohighlight">\(P(Y;m,p)\)</span>, then the sum is binomially distributed as
<span class="math notranslate nohighlight">\(P(X+Y; n+m, p)\)</span>.</p>
<div class="tip admonition">
<p class="admonition-title">Example:</p>
<p>What is the probability to get out of 10 coin tosses 3 times a “head”? Solution:
<span class="math notranslate nohighlight">\(P(3; 10, 0.5)={10 \choose 3}\,0.5^3\cdot (1-0.5)^{10-3}=\frac{10!}{3!7!}0.5^3\cdot 0.5^7=0.12\)</span></p>
</div>
<div class="tip admonition">
<p class="admonition-title">Example:</p>
<p>A detector with 4 layers has an efficiency per layer to
detect a traversing particle of 88%. To reconstruct the complete track
of the particle, we need at least three hits (i.e. three out of the four
layers have to detect the particle). What is the probability to
reconstruct the track?<br />
We need at least 3 hits (i.e. 3 or 4), so we have to sum the probability
to have 3 hits to the probability to have 4 hits:<br />
<span class="math notranslate nohighlight">\(P(r\ge 3; n=4, p=0.88) = P(r = 3; n=4, p=0.88) + P(r = 4; n=4, p=0.88) =\)</span><br />
<span class="math notranslate nohighlight">\(0.33 + 0.60 = 0.93\)</span></p>
<p>What if we have 3 or 5 layers?<br />
For 3 layers <span class="math notranslate nohighlight">\(= P(r = 3; n=3, p=0.88) = 0.68\)</span><br />
For 5 layers <span class="math notranslate nohighlight">\(= P(r \ge 3; n=5, p=0.88) = 0.10 + 0.36 + 0.53 = 0.99\)</span></p>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The binomial distribution for a fixed p=0.4 and different values of n</span>

<span class="n">p</span> <span class="o">=</span> <span class="mf">0.4</span>
<span class="n">n</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">]</span>
<span class="n">repetitions</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">N</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">repetitions</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;n = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;P(x=r)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/probabilityDistributions_10_0.png" src="_images/probabilityDistributions_10_0.png" />
</div>
</div>
</div>
<div class="section" id="multinomial-distribution">
<h3>Multinomial Distribution<a class="headerlink" href="#multinomial-distribution" title="Permalink to this headline">¶</a></h3>
<p>The precedent considerations can directly be generalized for the
multidimensional problem. Assume we have <span class="math notranslate nohighlight">\(n\)</span> objects of <span class="math notranslate nohighlight">\(k\)</span> different
types, and <span class="math notranslate nohighlight">\(r_{i}\)</span> is the number of objects of type <span class="math notranslate nohighlight">\(i\)</span>. The number of
distinguishable arrangements is then given by
<span class="math notranslate nohighlight">\(\frac{n!}{r_1!r_2!\cdots r_k!}\)</span>.
If we now choose randomly</p>
<div class="math notranslate nohighlight">
\[n = r_1 + r_2 + ... + r_k\]</div>
<p>objects (putting them back every time), then
the probability of getting an arrangement of <span class="math notranslate nohighlight">\(r_{1}\)</span> objects of type
<span class="math notranslate nohighlight">\(1\)</span>, <span class="math notranslate nohighlight">\(r_{2}\)</span> objects of type <span class="math notranslate nohighlight">\(2\)</span>, etc… is given by
<span class="math notranslate nohighlight">\(p_1^{r_1}\cdot p_2^{r_2}\cdots p_k^{r_k}\)</span>. The overall probability is
therefore simply the probability of our arrangement, multiplied with the
number of possible distinguishable arrangements:</p>
<div class="math notranslate nohighlight">
\[P(r_1,..,r_k;p_1,p_k)=\left(\frac{n!}{r_1!r_2!r_3!\cdots r_k!}\right)p_1^{r_1}\cdot p_2^{r_2}\cdots p_k^{r_k}.\]</div>
<p>This distribution is called the multinomial distribution and it is what
describes the probability to have <span class="math notranslate nohighlight">\(r_i\)</span> events in bin i of a histogram
with <span class="math notranslate nohighlight">\(n\)</span> entries. The corresponding properties are:</p>
<div class="math notranslate nohighlight">
\[&lt;r_i&gt;=np_i \qquad \textrm{and} \qquad \; V(r_i)=np_i(1-p_i).\]</div>
<p>You can also compute the covariance among the bins of a histogram:</p>
<div class="math notranslate nohighlight">
\[\mbox{cov}(r_i, r_j) = -n p_i p_j\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\rho_{ij} = \frac{\mbox{cov}(r_i,r_j)}{\sigma_i \sigma_j} = -\sqrt{\frac{p_i}{1-p_i}\frac{p_j}{1-p_j}}\]</div>
<p>The correlation among bins comes from the fact that the total number of entries <span class="math notranslate nohighlight">\(n = r_1+\ldots+r_k\)</span> is fixed, i.e. <span class="math notranslate nohighlight">\(r_i = n - r_1 - \ldots - r_{i-1} - r_{i+1} -\ldots - r_k .\)</span></p>
<p>If n is not fixed, i.e. n is another random variable, the bin entries are
uncorrelated and instead of having a multinomial we will have a Poisson
for each bin (see also <a class="reference external" href="./likelihood.html#sec:EMLF">extended maximum likelihood fit</a>).</p>
</div>
<div class="section" id="poisson-distribution">
<h3>Poisson Distribution<a class="headerlink" href="#poisson-distribution" title="Permalink to this headline">¶</a></h3>
<p>The Poisson p.d.f. applies to the situations where we detect events but
do not know the total number of trials. An example is a radioactive
source where we detect the decays but do not detect the non-decays.<br />
The distribution can be obtained as a limit of the binomial: let
<span class="math notranslate nohighlight">\(\lambda\)</span> be the probability to observe a radioactive decay in a period
<span class="math notranslate nohighlight">\(T\)</span> of time. Now divide the period <span class="math notranslate nohighlight">\(T\)</span> in <span class="math notranslate nohighlight">\(n\)</span> time intervals
<span class="math notranslate nohighlight">\(\Delta T  = T/n\)</span> small enough that the probability to observe two
decays in an interval is negligible. The probability to observe a decay
in <span class="math notranslate nohighlight">\(\Delta T\)</span> is then <span class="math notranslate nohighlight">\(\lambda / n\)</span>, while the probability to observe
<span class="math notranslate nohighlight">\(r\)</span> decays in the period <span class="math notranslate nohighlight">\(T\)</span> is given by the binomial probability to
observe <span class="math notranslate nohighlight">\(r\)</span> events in <span class="math notranslate nohighlight">\(n\)</span> trials each of which has a probability
<span class="math notranslate nohighlight">\(\lambda / n\)</span>.</p>
<div class="math notranslate nohighlight">
\[P\left(r; n,\frac{\lambda}{n} \right) = \frac{n!}{(n-r)!}\frac{1}{r!} \left( \frac{\lambda}{n}\right)^r \left( 1- \frac{\lambda}{n}  \right) ^{n-r} \label{eq:bin}\]</div>
<p>Under the assumption that <span class="math notranslate nohighlight">\(n &gt;&gt; r\)</span> then:</p>
<div class="math notranslate nohighlight">
\[\frac{n!}{(n-r)!} = n(n-1)(n-2)\dots(n-r+1) \sim n^r\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\left( 1- \frac{\lambda}{n}  \right) ^{n-r} \sim \left( 1- \frac{\lambda}{n}  \right) ^{n} \to e^{-\lambda} \qquad \textrm{for} \qquad n \to \infty\]</div>
<p>we obtain the Poisson p.d.f:</p>
<div class="math notranslate nohighlight">
\[P(r;\lambda) = \frac{\lambda^r e^{-\lambda}}{r!}.\]</div>
<p>The Poisson distribution can so be seen as the limit of the binomial
distribution when the number <span class="math notranslate nohighlight">\(n\)</span> of trials becomes very large and the
probability <span class="math notranslate nohighlight">\(p\)</span> for a single event becomes very small, while the product
<span class="math notranslate nohighlight">\(pn = \lambda\)</span> remains a (finite) constant. It gives the probability of
getting <span class="math notranslate nohighlight">\(r\)</span> events if the expected number (mean) is <span class="math notranslate nohighlight">\(\lambda\)</span>.</p>
<p>Properties of the Poisson distribution:</p>
<ul class="simple">
<li><p>it is normalized to 1:
<span class="math notranslate nohighlight">\(\sum_{r=0}^{\infty}P(r)=e^{-\lambda}\sum_{r=0}^{\infty}\frac{\lambda^r}{r!}=e^{-\lambda}e^{+\lambda}=1\)</span></p></li>
<li><p>the mean <span class="math notranslate nohighlight">\(&lt;r&gt;\)</span> is <span class="math notranslate nohighlight">\(\lambda\)</span>:
<span class="math notranslate nohighlight">\(&lt;r&gt;=\sum_{r=0}^{\infty}r\cdot \frac{e^{-\lambda}\lambda^r}{r!}=\lambda\)</span></p></li>
<li><p>the variance is <span class="math notranslate nohighlight">\(V(r)=\lambda\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(P(r+s;\lambda_r, \lambda_s) = \frac{(\lambda_r+\lambda_s)^{(r+s)} e^{-(\lambda_r+\lambda_s)}}{(r+s)!}\)</span>:
the p.d.f. of the sum of two Poisson distributed random variables is
also Poisson with <span class="math notranslate nohighlight">\(\lambda\)</span> equal to the sum of the <span class="math notranslate nohighlight">\(\lambda\)</span>’s of
the individual Poissons</p></li>
</ul>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>This example is mentioned for the first time in the book from L.
von Bortkiewicz in the year 1898: “Das Gesetz der kleinen Zahlen.”</p>
</div>
<div class="tip admonition">
<p class="admonition-title">Example:</p>
<p>An historical example is the number of deadly horse
accidents in the Prussian army. The fatal incidents were registered over
twenty years in ten different cavalry corps. There was a total of 122
fatal incidents, and therefore the expectation value per corps per year
is given by <span class="math notranslate nohighlight">\(\lambda = 122/200 =0.61\)</span>. The probability that no soldier
is killed per year and corps is
<span class="math notranslate nohighlight">\(P(0;0.61) = e^{-0.61} \cdot 0.61^{0} / 0! = 0.5434\)</span>. To get the total
events (of no incidents) in one year and per corps, we have to multiply
with the number of observed cases (here 200), which yields
<span class="math notranslate nohighlight">\(200 \cdot 0.5434 = 108.7\)</span>. The total statistics of the Prussian cavalry
is summarized in the following table in agreement with the Poisson expectation:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Fatal incidents per corps and year</p></th>
<th class="head"><p>Reported incidents</p></th>
<th class="head"><p>Poisson distribution</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>109</p></td>
<td><p>108.7</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>65</p></td>
<td><p>66.3</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>22</p></td>
<td><p>20.2</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>3</p></td>
<td><p>4.1</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>1</p></td>
<td><p>0.6</p></td>
</tr>
</tbody>
</table>
</div>
<p>The Poisson distribution is very often used in counting experiments:</p>
<ul class="simple">
<li><p>number of particles which are registered by a detector in the time
interval <span class="math notranslate nohighlight">\(t\)</span>, if the flux <span class="math notranslate nohighlight">\(\Phi\)</span> and the efficiency of the detector
are independent of time and the dead time of the detector <span class="math notranslate nohighlight">\(\tau\)</span> is
sufficiently small, such that <span class="math notranslate nohighlight">\(\phi \tau \ll 1\)</span></p></li>
<li><p>number of interactions caused by an intense beam of particles which
travel through a thin foil</p></li>
<li><p>number of entries in a histogram, if the data are taken during a
fixed time interval</p></li>
<li><p>number of flat tires when traveling a certain distance, if the
expectation value flats / distance is constant</p></li>
</ul>
<p>Some counter-examples, in which the Poisson distribution <em>cannot</em> be
used:</p>
<ul class="simple">
<li><p>the decay of a small amount of radioactive material in a certain
time interval, if this interval is comparable to the lifetime</p></li>
<li><p>the number of interactions of a beam of only a few particles which
pass through a thick foil</p></li>
</ul>
<p>In both cases we have the event rate is not constant (in the first it
decreases with time, in the second with distance) and therefore the
Poisson distribution cannot be applied.</p>
<p>The Poisson p.d.f. requires that the events be independent. Consider the
case of a counter with a dead time of 1 <span class="math notranslate nohighlight">\(\mu sec\)</span>. This means that if a
second particle passes through the counter within 1 <span class="math notranslate nohighlight">\(\mu sec\)</span> after one
which was recorded, the counter is incapable of recording the second
particle. Thus the detection of a particle is not independent of the
detection of other particles. If the particle flux is low, the chance of
a second particle within the dead time is so small that it can be
neglected. However, if the flux is high it cannot be. No matter how high
the flux, the counter cannot count more than <span class="math notranslate nohighlight">\(10^6\)</span> particles per
second. In high fluxes, the number of particles detected in some time
interval will not be Poisson distributed.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># poisson distribution for different values of lambda</span>

<span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">repetitions</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">l_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
    <span class="n">samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">poisson</span><span class="p">(</span><span class="n">l_</span><span class="p">,</span> <span class="n">repetitions</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">samples</span><span class="p">))</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;$\lambda$ = </span><span class="si">{</span><span class="n">l_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;P(x=r)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/probabilityDistributions_13_0.png" src="_images/probabilityDistributions_13_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="continuous-distributions">
<h2>Continuous Distributions<a class="headerlink" href="#continuous-distributions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="uniform-distribution">
<h3>Uniform Distribution<a class="headerlink" href="#uniform-distribution" title="Permalink to this headline">¶</a></h3>
<p>The probability density function of the uniform distribution in the
interval <span class="math notranslate nohighlight">\([a,b]\)</span> is given by:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
f(x)= 
\begin{cases} 
\frac{1}{b-a} \quad &amp;\text{if } a \le x \le b \\
                                0 &amp;\text{else}.
\end{cases}
\end{split}\]</div>
<p>The expectation value and the variance are given by</p>
<p><span class="math notranslate nohighlight">\( &lt;x&gt; = \int_a^b\frac{x}{b-a}dx=\frac{1}{2}(a+b) \)</span></p>
<p><span class="math notranslate nohighlight">\( \mbox{Var}(x) = \frac{1}{12}(b-a)^2 \)</span></p>
<div class="tip admonition">
<p class="admonition-title">Example:</p>
<p>Consider a detector built as a single strip of silicon with
a width of 1mm. If a charged particle hits it, the detector reads 1
otherwise zero (binary readout). What is the spacial resolution of the
detector? Estimating the resolution as the variance of the corresponding
uniform distribution, we get <span class="math notranslate nohighlight">\(\sim 290\mu m\)</span>.</p>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">uniform</span>

<span class="n">params</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">)]</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">limits</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">axf</span><span class="p">,</span> <span class="n">axF</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ab</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">ab</span>
    <span class="n">frozen</span> <span class="o">=</span> <span class="n">uniform</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">*</span><span class="n">limits</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
    <span class="n">fx</span> <span class="o">=</span> <span class="n">frozen</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">Fx</span> <span class="o">=</span> <span class="n">frozen</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fx</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;a=</span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s2">, b=</span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">axF</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Fx</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;a=</span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s2">, b=</span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axF</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;f(x)&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">axF</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;F(x)&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">limits</span><span class="p">)</span>
    <span class="n">axF</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">limits</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/probabilityDistributions_16_0.png" src="_images/probabilityDistributions_16_0.png" />
</div>
</div>
</div>
<div class="section" id="gaussian-or-normal-distribution">
<h3>Gaussian or Normal Distribution<a class="headerlink" href="#gaussian-or-normal-distribution" title="Permalink to this headline">¶</a></h3>
<p>The Gaussian or normal distribution is probably the most important
and useful distribution we know. The probability density function is</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>C.F. Gauss did not discovery it all alone. Independently, Laplace
and de Moivre knew about this distribution.</p>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>A legend says that Gauss did describe the size of bread loaves in
the city of Königsberg with the normal distribution.</p>
</div>
<div class="math notranslate nohighlight">
\[
f(x;\mu,\sigma)=\frac{1}{\sqrt{2\pi}\sigma}e^{-\frac{(x-\mu)^2}{2\sigma^2}}.
\]</div>
<p>The Gaussian distribution is described by two parameters: the mean value
<span class="math notranslate nohighlight">\(\mu\)</span> and the variance <span class="math notranslate nohighlight">\(\sigma^{2}\)</span> or the standard deviation <span class="math notranslate nohighlight">\(\sigma\)</span>.
By substituting <span class="math notranslate nohighlight">\(z = (x-\mu) / \sigma\)</span> we obtain the so-called normal or
standardized Gaussian distribution:</p>
<div class="math notranslate nohighlight">
\[
N(0,1)=\frac{1}{\sqrt{2\pi}}e^{-z^2/2}.
\]</div>
<p>It has an mean of zero and standard deviation 1.</p>
<p>Properties of the normal distribution are:</p>
<ul class="simple">
<li><p>it is normalized to 1: <span class="math notranslate nohighlight">\(\int_{-\infty}^{+\infty}P(x;\mu,\sigma)dx=1\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\mu\)</span> is the first moment of the distribution:
<span class="math notranslate nohighlight">\(\int_{-\infty}^{+\infty}xP(x;\mu,\sigma)dx=\mu\)</span></p></li>
<li><p>being a symmetric distribution, <span class="math notranslate nohighlight">\(\mu\)</span> is also its mode and median</p></li>
<li><p>its second central moment is <span class="math notranslate nohighlight">\(\sigma^2\)</span>:
<span class="math notranslate nohighlight">\(\int_{-\infty}^{+\infty}(x-\mu)^2P(x;\mu,\sigma)dx=\sigma^2\)</span></p></li>
</ul>
<p>If <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> are two independent r.v.’s distributed as
<span class="math notranslate nohighlight">\(f(x;\mu_x,\sigma_x)\)</span> and <span class="math notranslate nohighlight">\(f(y;\mu_y,\sigma_y)\)</span> then Z = X + Y is
distributed as <span class="math notranslate nohighlight">\(f(z;\mu_z,\sigma_z)\)</span> with <span class="math notranslate nohighlight">\(\mu_z = \mu_x+\mu_y\)</span> and
<span class="math notranslate nohighlight">\(\sigma_z^2 = \sigma_x^2 + \sigma_y^2\)</span>.</p>
<p>Some useful integrals, which are often used when working with the
Gaussian function:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\int_{-\infty}^{+\infty}e^{-ax^2}dx &amp; = &amp; \sqrt{\pi/a}\\
\int_{0}^{+\infty}xe^{-ax^2}dx &amp; = &amp; \frac{1}{2a}\\
\int_{-\infty}^{+\infty}x^2e^{-ax^2}dx &amp; = &amp; \frac{1}{2a}\sqrt{\pi/a}\\
\int_{0}^{+\infty}x^{2n+1}e^{-ax^2}dx &amp; = &amp; \frac{n!}{2a^{n+1}}\\
\int_{-\infty}^{+\infty}x^{2n+1}e^{-ax^2}dx &amp; = &amp;0, \, \mbox{for all odd values of $n$} \\
\end{aligned}
\end{split}\]</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>

<span class="n">params</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)]</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">limits</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">axf</span><span class="p">,</span> <span class="n">axF</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">musigma</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
    <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="n">musigma</span>
    <span class="n">frozen</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">*</span><span class="n">limits</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
    <span class="n">fx</span> <span class="o">=</span> <span class="n">frozen</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">Fx</span> <span class="o">=</span> <span class="n">frozen</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fx</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$\mu$=</span><span class="si">{</span><span class="n">mu</span><span class="si">}</span><span class="s2">, $\sigma$=</span><span class="si">{</span><span class="n">sigma</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">axF</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Fx</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$\mu$=</span><span class="si">{</span><span class="n">mu</span><span class="si">}</span><span class="s2">, $\sigma$=</span><span class="si">{</span><span class="n">sigma</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axF</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;f(x)&quot;</span><span class="p">)</span>
    <span class="n">axF</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;F(x)&quot;</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">limits</span><span class="p">)</span>
    <span class="n">axF</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">limits</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/probabilityDistributions_18_0.png" src="_images/probabilityDistributions_18_0.png" />
</div>
</div>
<p>Here are some numbers for the integrated Gaussian distribution:</p>
<ul class="simple">
<li><p>68.27% of the area lies within <span class="math notranslate nohighlight">\(\pm\sigma\)</span> around the mean <span class="math notranslate nohighlight">\(\mu\)</span></p></li>
<li><p>95.45% lies within <span class="math notranslate nohighlight">\(\pm 2\sigma\)</span> around the mean <span class="math notranslate nohighlight">\(\mu\)</span></p></li>
<li><p>99.73% lies within <span class="math notranslate nohighlight">\(\pm 3 \sigma\)</span> around the mean <span class="math notranslate nohighlight">\(\mu\)</span></p></li>
<li><p>90% of the area lies within <span class="math notranslate nohighlight">\(\pm 1.645\sigma\)</span> around the mean <span class="math notranslate nohighlight">\(\mu\)</span></p></li>
<li><p>95% lies within <span class="math notranslate nohighlight">\(\pm 1.960\sigma\)</span> around the mean <span class="math notranslate nohighlight">\(\mu\)</span></p></li>
<li><p>99% lies within <span class="math notranslate nohighlight">\(\pm 2.576\sigma\)</span> around the mean <span class="math notranslate nohighlight">\(\mu\)</span></p></li>
<li><p>99.9% lies within <span class="math notranslate nohighlight">\(\pm 3.290\sigma\)</span> around the mean <span class="math notranslate nohighlight">\(\mu\)</span></p></li>
</ul>
<p>The integrated Gaussian function <span class="math notranslate nohighlight">\(\Phi(x)\)</span> can also be expressed by the
so-called error function <span class="math notranslate nohighlight">\(erf(x)\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\Phi(x)&amp;=&amp;\frac{1}{\sqrt{2\pi}\sigma}\int_{-\infty}^{x}e^{-(t-\mu)^2/2\sigma^2}dt \\
erf(x)&amp;=&amp;\frac{2}{\sqrt{\pi}}\int_0^xe^{-t^2}dt \\
=&gt;\Phi(x)&amp;=&amp;\frac{1}{2}\left(1+erf(\frac{x-\mu}{\sqrt{2}\sigma})\right)\\
\end{aligned}
\end{split}\]</div>
<p>The <em>Full Width Half Maximum</em> (FWHM) is very useful to get a quick
estimate for the width of a distribution and for the specific case of
the Gaussian we have: <span class="math notranslate nohighlight">\(FWHM=2\sigma\sqrt{2\ln 2}=2.355\sigma.\)</span>
The Gaussian distribution is the limiting case for several other p.d.f.’s we
will encounter later (see (see <a class="reference internal" href="#fig-limits"><span class="std std-numref">Fig. 3</span></a>)).
This is a consequence of the central limit theorem (CLT) (discussed in
<a class="reference external" href="./probabilityDistributions.html#the-central-limit-theorem">CLT</a>)</p>
<div class="figure align-center" id="fig-limits">
<a class="reference internal image-reference" href="_images/limits.png"><img alt="_images/limits.png" src="_images/limits.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-number">Fig. 3 </span><span class="caption-text">Limiting cases. FIXME ref Metzger</span><a class="headerlink" href="#fig-limits" title="Permalink to this image">¶</a></p>
</div>
<p>The N-dimensional Gaussian distribution is defined by</p>
<div class="math notranslate nohighlight">
\[
f({\bf x};{\bf \mu}, V)=\frac{1}{(2\pi)^{N/2}|V|^{1/2}}\exp\left(-\frac{1}{2}({\bf x}-{\bf \mu})^TV^{-1}({\bf x}-{\bf \mu})\right).
\]</div>
<p>Here, <span class="math notranslate nohighlight">\({\bf x}\)</span> and <span class="math notranslate nohighlight">\({\bf \mu}\)</span> are column vectors with the components
<span class="math notranslate nohighlight">\(x_1,\ldots ,x_N\)</span> and <span class="math notranslate nohighlight">\(\mu_1,\ldots ,\mu_N\)</span>, respectively. The
transposed vectors <span class="math notranslate nohighlight">\({\bf x}^T\)</span> and <span class="math notranslate nohighlight">\({\bf \mu}^T\)</span> are the corresponding
row vectors and <span class="math notranslate nohighlight">\(|V|\)</span> is the determinant of the symmetric <span class="math notranslate nohighlight">\(N \times N\)</span>
covariance matrix <span class="math notranslate nohighlight">\(V\)</span>. The expectation values and the covariances are
given by:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\langle x_i \rangle=\mu_i\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\mbox{V}(x_i)=\mbox{V}_{ii}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\mbox{cov}(x_i,x_j)=\mbox{V}_{ij}\)</span></p></li>
</ul>
<p>In the simplified case of a two-dimensional Gaussian distribution we can
write</p>
<div class="math notranslate nohighlight">
\[
f(x_1,x_2;\mu_1\,\mu_2,\sigma_1,\sigma_2,\rho) = 
\]</div>
<div class="math notranslate nohighlight">
\[
 \frac{1}{2\pi\sigma_1\sigma_2\sqrt{1-\rho^2}} \cdot \exp \left( -\frac{1}{2(1-\rho^2)}\right)
\cdot \left[\left(\frac{x_1-\mu_1}{\sigma_1}\right)^2 + 
\left(\frac{x_2-\mu_2}{\sigma_2}\right)^2
-2\rho\left(\frac{x_1-\mu_1}{\sigma_1}\right)
\left(\frac{x_2-\mu_2}{\sigma_2}\right)\right].
\]</div>
<p>We will come back to the specific case of the gaussian distribution in multiple
dimensions in the chapter <a class="reference external" href="./errors.html#a-closer-look-at-the-error-matrix-sec-errormatrix">Measurement Uncertainties</a> when talking about the error matrix.</p>
</div>
<div class="section" id="chi-2-distribution">
<h3><span class="math notranslate nohighlight">\(\chi^2\)</span> Distribution<a class="headerlink" href="#chi-2-distribution" title="Permalink to this headline">¶</a></h3>
<p>Assume that <span class="math notranslate nohighlight">\(x_{1}, x_{2}, \cdots, x_{n}\)</span> are independent random
variables, which obey a Gaussian distribution. Then the joint p.d.f. is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
f({\bf x}; {\bf \mu}, {\bf \sigma}) &amp;=&amp; \prod_{i=1}^{n} \frac{1}{\sqrt{2\pi} \sigma_i}\exp\left[-\frac{1}{2} \left( \frac{x_i - \mu_i}{\sigma_i}\right)^2 \right]\\
&amp;=&amp; \exp \left[ -\frac{1}{2} \sum_{i=1}^{n} \left( \frac{x_i - \mu_i}{\sigma_i}\right)^2 \right]  \prod_{i=1}^{n} \frac{1}{\sqrt{2\pi} \sigma_i}
\end{aligned}
\end{split}\]</div>
<p>Then the variable <span class="math notranslate nohighlight">\(\chi^{2}(n)\)</span> defined as</p>
<div class="math notranslate nohighlight">
\[
\chi^2(n)=\sum_{i=1}^{n}\left(\frac{x_i-\mu_i}{\sigma_i}\right)^2
\]</div>
<p>being a function of random variables is itself a random variable
distributed as a <span class="math notranslate nohighlight">\(\chi^{2}\)</span> distribution with <span class="math notranslate nohighlight">\(n\)</span> degrees of freedom.
The probability density is given by:</p>
<div class="math notranslate nohighlight">
\[
\chi^2(n) = f(\chi^2;n) = \frac{(\chi^2)^{n/2-1}e^{-\chi^2/2}}{\Gamma(n/2)2^{n/2}}.
\]</div>
<p>The <span class="math notranslate nohighlight">\(\chi^2(n)\)</span> p.d.f. has the properties:</p>
<ul class="simple">
<li><p>mean = <span class="math notranslate nohighlight">\(n\)</span></p></li>
<li><p>variance = <span class="math notranslate nohighlight">\(2n\)</span></p></li>
<li><p>mode = n-2 for <span class="math notranslate nohighlight">\(n\ge2\)</span> and 0 for <span class="math notranslate nohighlight">\(n\le2\)</span></p></li>
<li><p>reproductive property:
<span class="math notranslate nohighlight">\(\chi^2_{n_1+n_2} = \chi^2_{n_1} + \chi^2_{n_2} = \chi^2(n_1+n_2)\)</span></p></li>
</ul>
<p>Since the expectation of <span class="math notranslate nohighlight">\(\chi^2(n)\)</span> is <span class="math notranslate nohighlight">\(n\)</span>, the expectation of
<span class="math notranslate nohighlight">\(\chi^2(n)/n\)</span> is 1. The quantity <span class="math notranslate nohighlight">\(\chi^2(n)/n\)</span> is called “reduced
<span class="math notranslate nohighlight">\(\chi^2\)</span>”.</p>
<p>For <span class="math notranslate nohighlight">\(n \to \infty\)</span>, <span class="math notranslate nohighlight">\(\chi^{2}(n)\to N(\chi^2;n,2n)\)</span> becomes a normal
distribution. When using the <span class="math notranslate nohighlight">\(\chi^{2}\)</span>-distribution in practice, the
approximation by a normal distribution is already sufficient for
<span class="math notranslate nohighlight">\(n \ge 30\)</span>.</p>
<p>To understand the notation take the particular case of the <span class="math notranslate nohighlight">\(\chi^2\)</span> for
1 degree of freedom. Let <span class="math notranslate nohighlight">\(z = (x-\mu)/\sigma\)</span> so that the p.d.f. for <span class="math notranslate nohighlight">\(z\)</span>
is <span class="math notranslate nohighlight">\(N(z; 0, 1)\)</span> and the probability that <span class="math notranslate nohighlight">\(z \le Z \le z + dz\)</span> is:</p>
<div class="math notranslate nohighlight">
\[
f(z)dz = \frac{1}{\sqrt2\pi} e^{-\frac{1}{2} z^2 }dz.
\]</div>
<p>Let <span class="math notranslate nohighlight">\(Q = Z^2.\)</span> (We use Q here instead of <span class="math notranslate nohighlight">\(\chi^2\)</span> to emphasize that this is the
variable.) This is not a one-to-one transformation because both <span class="math notranslate nohighlight">\(+Z\)</span> and
<span class="math notranslate nohighlight">\(-Z\)</span> go into <span class="math notranslate nohighlight">\(+Q\)</span>.</p>
<p>The probability that <span class="math notranslate nohighlight">\(Q\)</span> is between <span class="math notranslate nohighlight">\(q\)</span> and <span class="math notranslate nohighlight">\(q + dq\)</span> is the sum of the
probability that <span class="math notranslate nohighlight">\(Z\)</span> is between <span class="math notranslate nohighlight">\(z\)</span> and <span class="math notranslate nohighlight">\(z + dz\)</span> around <span class="math notranslate nohighlight">\(z = \sqrt{q}\)</span>,
and the probability that <span class="math notranslate nohighlight">\(Z\)</span> is between <span class="math notranslate nohighlight">\(z\)</span> and <span class="math notranslate nohighlight">\(z -dz\)</span> around
<span class="math notranslate nohighlight">\(z = -\sqrt{q}\)</span>. The Jacobian is:</p>
<div class="math notranslate nohighlight">
\[
J_{\pm} = \frac{d(\pm z)}{dq} = \pm \frac{1}{2\sqrt{q}}
\]</div>
<p>so</p>
<div class="math notranslate nohighlight">
\[
f(q)dq=  \frac{1}{\sqrt{2\pi}} e^{-\frac{1}{2}q}(|J_+| + |J_-|) dq  =  \frac{1}{\sqrt{2\pi}} e^{-\frac{1}{2}q}(\frac{dq}{2\sqrt{q}} + \frac{dq}{2\sqrt{q}}) dq = \frac{1}{\sqrt{2\pi q}} e^{-\frac{1}{2}q} dq
\]</div>
<p>Replacing <span class="math notranslate nohighlight">\(\chi^2\)</span> for <span class="math notranslate nohighlight">\(Q\)</span> we have:</p>
<div class="math notranslate nohighlight">
\[
\chi^2(1) = \frac{1}{\sqrt{2\pi\chi^2}}e^{-\frac{1}{2} \chi^2}
\]</div>
<p>(careful! the same symbol is used for the random variable and the p.d.f.).</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">chi2</span>

<span class="n">dofs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">limits</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">axf</span><span class="p">,</span> <span class="n">axF</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">dof</span> <span class="ow">in</span> <span class="n">dofs</span><span class="p">:</span>
    <span class="n">frozen</span> <span class="o">=</span> <span class="n">chi2</span><span class="p">(</span><span class="n">dof</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">*</span><span class="n">limits</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
    <span class="n">fx</span> <span class="o">=</span> <span class="n">frozen</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">Fx</span> <span class="o">=</span> <span class="n">frozen</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fx</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;n=</span><span class="si">{</span><span class="n">dof</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">axF</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Fx</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;n=</span><span class="si">{</span><span class="n">dof</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axF</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;f(x)&quot;</span><span class="p">)</span>
    <span class="n">axF</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;F(x)&quot;</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">limits</span><span class="p">)</span>
    <span class="n">axF</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">limits</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/probabilityDistributions_21_0.png" src="_images/probabilityDistributions_21_0.png" />
</div>
</div>
</div>
<div class="section" id="log-normal-distribution">
<h3>Log-Normal Distribution<a class="headerlink" href="#log-normal-distribution" title="Permalink to this headline">¶</a></h3>
<p>If <span class="math notranslate nohighlight">\(y\)</span> obeys a normal distribution with mean <span class="math notranslate nohighlight">\(\mu\)</span> and standard
deviation <span class="math notranslate nohighlight">\(\sigma\)</span>, then it follows that <span class="math notranslate nohighlight">\(x=e^{y}\)</span> obeys a log-normal
distribution. This means that <span class="math notranslate nohighlight">\(\ln(x)\)</span> is normal distributed  (see figure below):</p>
<div class="math notranslate nohighlight">
\[
f(x; \mu, \sigma)=\frac{1}{\sqrt{2\pi\sigma^2}}\frac{1}{x}e^{-(\ln x-\mu)^2/2\sigma^2}.
\]</div>
<p>The expectation value and the variance are given by:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
&lt;x&gt;&amp;=&amp;e^{(\mu+\frac{1}{2}\sigma^2)} \\
\mbox{Var}(x)&amp;=&amp;e^{(2\mu+\sigma^2)}(e^{\sigma^2}-1)
\end{aligned}
\end{split}\]</div>
<p>The log-normal distribution is typically used when the resolution of a
measurement apparatus is composed by different sources, each
contributing a (multiplicative) amount to the overall resolution. As the
<em>sum</em> of many small contributions of any random distribution converges
by the central limit theorem to a Gaussian distribution, so the
<em>product</em> of many small contributions is distributed according to a
log-normal distribution.</p>
<div class="tip admonition">
<p class="admonition-title">Example:</p>
<p>Consider the signal of a photomultiplier (PMT), which
converts light signals into electric signals. Each photon hitting the
photo-cathode emits an electron, which gets accelerated by an electric
field generated by an electrode (dynode) behind. The electron hits the
dynode and emits other secondary electrons which gets accelerated to the
next dynode. This process if repeated several times (as many as the
number of dynodes in the PMT). At every stage the number of secondary
electrons emitted depends on the voltage applied. If the amplification
per step is <span class="math notranslate nohighlight">\(a_{i}\)</span>, then the number of electrons after the <span class="math notranslate nohighlight">\(k^{th}\)</span>
step, <span class="math notranslate nohighlight">\(n_{k} = \Pi_{i=0}^{k} a_{i}\)</span>, is approximately log-normal
distributed.</p>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">lognorm</span>

<span class="n">params</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">limits</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">axf</span><span class="p">,</span> <span class="n">axF</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">musigma</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
    <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="n">musigma</span>
    <span class="n">frozen</span> <span class="o">=</span> <span class="n">lognorm</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">mu</span><span class="p">))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">*</span><span class="n">limits</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
    <span class="n">fx</span> <span class="o">=</span> <span class="n">frozen</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">Fx</span> <span class="o">=</span> <span class="n">frozen</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fx</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$\mu$=</span><span class="si">{</span><span class="n">mu</span><span class="si">}</span><span class="s2">, $\sigma$=</span><span class="si">{</span><span class="n">sigma</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">axF</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Fx</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$\mu$=</span><span class="si">{</span><span class="n">mu</span><span class="si">}</span><span class="s2">, $\sigma$=</span><span class="si">{</span><span class="n">sigma</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axF</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;f(x)&quot;</span><span class="p">)</span>
    <span class="n">axF</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;F(x)&quot;</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">limits</span><span class="p">)</span>
    <span class="n">axF</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">limits</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/probabilityDistributions_23_0.png" src="_images/probabilityDistributions_23_0.png" />
</div>
</div>
</div>
<div class="section" id="exponential-distribution">
<h3>Exponential Distribution<a class="headerlink" href="#exponential-distribution" title="Permalink to this headline">¶</a></h3>
<p>The exponential distribution is defined for a continuous variable <span class="math notranslate nohighlight">\(t\)</span> (<span class="math notranslate nohighlight">\(0 \le t \le \infty\)</span>) by:</p>
<div class="math notranslate nohighlight">
\[
f(t,\tau)=\frac{1}{\tau}e^{-t/\tau}.
\]</div>
<p>The probability density is characterized by one single parameter <span class="math notranslate nohighlight">\(\tau\)</span>.</p>
<ul class="simple">
<li><p>The expectation value is
<span class="math notranslate nohighlight">\(\langle t \rangle=\frac{1}{\tau}\int_0^{\infty}te^{-t/\tau}dt=\tau.\)</span></p></li>
<li><p>The variance is <span class="math notranslate nohighlight">\(\mbox{Var}(t)=\tau^2\)</span>.</p></li>
</ul>
<p>An example for the application of the exponential distribution is the
description of the proper-decay-time decay <span class="math notranslate nohighlight">\((t)\)</span> of an unstable
particles. The parameter <span class="math notranslate nohighlight">\(\tau\)</span> corresponds in this case to the mean
lifetime of the particle.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># PDF, PDF log scale and CDF</span>

<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">expon</span>

<span class="n">taus</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">]</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">limits</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">axf</span><span class="p">,</span> <span class="n">axf_log</span><span class="p">,</span> <span class="n">axF</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">tau</span> <span class="ow">in</span> <span class="n">taus</span><span class="p">:</span>
    <span class="n">frozen</span> <span class="o">=</span> <span class="n">expon</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="n">tau</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">*</span><span class="n">limits</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
    <span class="n">fx</span> <span class="o">=</span> <span class="n">frozen</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">Fx</span> <span class="o">=</span> <span class="n">frozen</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fx</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">tau$=</span><span class="si">{</span><span class="n">tau</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">axf_log</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fx</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">tau$=</span><span class="si">{</span><span class="n">tau</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">axF</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Fx</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">tau$=</span><span class="si">{</span><span class="n">tau</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axF</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;f(x)&quot;</span><span class="p">)</span>
    <span class="n">axf_log</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;f(x)&quot;</span><span class="p">)</span>
    <span class="n">axF</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;F(x)&quot;</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">limits</span><span class="p">)</span>
    <span class="n">axf_log</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">limits</span><span class="p">)</span>
    <span class="n">axF</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">limits</span><span class="p">)</span>
    <span class="n">axf_log</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/probabilityDistributions_25_0.png" src="_images/probabilityDistributions_25_0.png" />
</div>
</div>
</div>
<div class="section" id="gamma-distribution">
<h3>Gamma Distribution<a class="headerlink" href="#gamma-distribution" title="Permalink to this headline">¶</a></h3>
<p>The gamma distribution is given by:</p>
<div class="math notranslate nohighlight">
\[
f(x;k,\lambda)=\lambda^{k}\frac{x^{k-1}e^{-\lambda x}}{\Gamma(k)}.
\]</div>
<ul class="simple">
<li><p>The expectation value is <span class="math notranslate nohighlight">\(&lt;x&gt; = k / \lambda\)</span>.</p></li>
<li><p>The variance is <span class="math notranslate nohighlight">\(\sigma ^{2} = k / \lambda^{2}\)</span>.</p></li>
</ul>
<p>Special cases:</p>
<ul class="simple">
<li><p>for <span class="math notranslate nohighlight">\(\lambda = 1/2\)</span> and <span class="math notranslate nohighlight">\(k=n/2\)</span> the gamma distribution has the form
of a <span class="math notranslate nohighlight">\(\chi^2\)</span> distribution with n degrees of freedom.</p></li>
</ul>
<p>The Gamma distribution describes the distribution of the time <span class="math notranslate nohighlight">\(t=x\)</span>
between the first and the <span class="math notranslate nohighlight">\(k^{th}\)</span> event in a Poisson process with mean
<span class="math notranslate nohighlight">\(\lambda\)</span>. The parameter <span class="math notranslate nohighlight">\(k\)</span> influences the shape of the distribution,
whereas <span class="math notranslate nohighlight">\(\lambda\)</span> is just a scale parameter.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">gamma</span>

<span class="n">params</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">limits</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">axf</span><span class="p">,</span> <span class="n">axF</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">kl</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
    <span class="n">k</span><span class="p">,</span> <span class="n">l</span> <span class="o">=</span> <span class="n">kl</span>
    <span class="n">frozen</span> <span class="o">=</span> <span class="n">gamma</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">l</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">*</span><span class="n">limits</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
    <span class="n">fx</span> <span class="o">=</span> <span class="n">frozen</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">Fx</span> <span class="o">=</span> <span class="n">frozen</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fx</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$k$=</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">, $\lambda$=</span><span class="si">{</span><span class="n">l</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">axF</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Fx</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$k$=</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">, $\lambda$=</span><span class="si">{</span><span class="n">l</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axF</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;f(x)&quot;</span><span class="p">)</span>
    <span class="n">axF</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;F(x)&quot;</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">limits</span><span class="p">)</span>
    <span class="n">axF</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">limits</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/probabilityDistributions_27_0.png" src="_images/probabilityDistributions_27_0.png" />
</div>
</div>
</div>
<div class="section" id="student-s-t-distribution">
<h3>Student’s <span class="math notranslate nohighlight">\(t\)</span>-distribution<a class="headerlink" href="#student-s-t-distribution" title="Permalink to this headline">¶</a></h3>
<p>The Student’s <span class="math notranslate nohighlight">\(t\)</span> distribution is used when the standard deviation
<span class="math notranslate nohighlight">\(\sigma\)</span> of the parent distribution is unknown and the one evaluated
from the sample <span class="math notranslate nohighlight">\(s\)</span> is used. Suppose that <span class="math notranslate nohighlight">\(x\)</span> is a random variable
distributed normally (mean <span class="math notranslate nohighlight">\(\mu\)</span>, variance <span class="math notranslate nohighlight">\(\sigma^{2}\)</span>), and a
measurement of <span class="math notranslate nohighlight">\(x\)</span> yields the sample mean <span class="math notranslate nohighlight">\(\bar{x}\)</span> and the sample
variance <span class="math notranslate nohighlight">\(s^{2}\)</span>. Then the variable <span class="math notranslate nohighlight">\(t\)</span> is defined as</p>
<div class="math notranslate nohighlight" id="equation-definingequationvariablet">
<span class="eqno">(3)<a class="headerlink" href="#equation-definingequationvariablet" title="Permalink to this equation">¶</a></span>\[t = \frac{(\bar{x} - \mu) / \sigma}{s / \sigma} = \frac{\bar{x} - \mu}{s}.\]</div>
<p>You can see that we have canceled
our ignorance about the standard deviation of the parent distribution by
taking the ratio. The net effect is to substitute <span class="math notranslate nohighlight">\(\sigma\)</span> with the
estimated <span class="math notranslate nohighlight">\(s\)</span>.<br />
The quantity <span class="math notranslate nohighlight">\(t\)</span> follows the p.d.f. <span class="math notranslate nohighlight">\(f_n(t)\)</span> with <span class="math notranslate nohighlight">\(n\)</span> degrees of freedom:</p>
<div class="math notranslate nohighlight">
\[
f_n(t)=\frac{1}{\sqrt{n\pi}}\frac{\Gamma((n+1)/2)}{\Gamma(n/2)}\left(1+\frac{t^2}{n}\right)^{-(n+1)/2}
\]</div>
<p>If the true mean <span class="math notranslate nohighlight">\(\mu\)</span> is known, then <span class="math notranslate nohighlight">\(n = N\)</span> with <span class="math notranslate nohighlight">\(N\)</span> being the number
of measurements, if the true mean is unknown then <span class="math notranslate nohighlight">\(n = N -1\)</span> because one
degree of freedom is used for the sample mean <span class="math notranslate nohighlight">\(\bar{x}\)</span>.</p>
<p>The distribution depends only on the sample mean <span class="math notranslate nohighlight">\(\bar{x}\)</span> and the
sample variance <span class="math notranslate nohighlight">\(s\)</span>.</p>
<p>In general, the variable:</p>
<div class="math notranslate nohighlight">
\[
T=\frac{Z}{\sqrt{S^2/n}}
\]</div>
<p>is governed by the Student’s t distribution for n degrees of freedom if <span class="math notranslate nohighlight">\(Z\)</span> and <span class="math notranslate nohighlight">\(S^2\)</span>
are two independent random variables following respectively a normal
distribution <span class="math notranslate nohighlight">\(\mathcal{N}(0,1)\)</span> and the <span class="math notranslate nohighlight">\(\chi^2\)</span> distribution
<span class="math notranslate nohighlight">\(\chi^2(n)\)</span> with n degrees of freedom.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">t</span>

<span class="n">dofs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">limits</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">axf</span><span class="p">,</span> <span class="n">axF</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">dof</span> <span class="ow">in</span> <span class="n">dofs</span><span class="p">:</span>
    <span class="n">frozen</span> <span class="o">=</span> <span class="n">t</span><span class="p">(</span><span class="n">dof</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">*</span><span class="n">limits</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
    <span class="n">fx</span> <span class="o">=</span> <span class="n">frozen</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">Fx</span> <span class="o">=</span> <span class="n">frozen</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fx</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;n=</span><span class="si">{</span><span class="n">dof</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">axF</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Fx</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;n=</span><span class="si">{</span><span class="n">dof</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axF</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;f(x)&quot;</span><span class="p">)</span>
    <span class="n">axF</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;F(x)&quot;</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">limits</span><span class="p">)</span>
    <span class="n">axF</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">limits</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/probabilityDistributions_29_0.png" src="_images/probabilityDistributions_29_0.png" />
</div>
</div>
</div>
<div class="section" id="f-distribution">
<h3><span class="math notranslate nohighlight">\(F\)</span>-distribution<a class="headerlink" href="#f-distribution" title="Permalink to this headline">¶</a></h3>
<p>Consider two random variables, <span class="math notranslate nohighlight">\(\chi_1^2\)</span> and <span class="math notranslate nohighlight">\(\chi_2^2\)</span>, distributed as
<span class="math notranslate nohighlight">\(\chi^2\)</span> with <span class="math notranslate nohighlight">\(\nu_1\)</span> and <span class="math notranslate nohighlight">\(\nu_2\)</span> degrees of freedom, respectively. We
define a new random variable <span class="math notranslate nohighlight">\(F\)</span> as:</p>
<div class="math notranslate nohighlight">
\[
F = \frac{\chi_1^2/\nu_1}{\chi_2^2/\nu_2}
\]</div>
<p>The random variable <span class="math notranslate nohighlight">\(F\)</span> follows the distribution:</p>
<div class="math notranslate nohighlight">
\[
f(F)=\left(\frac{n_1}{n_2}\right)^{n_1/2}\cdot \frac{\Gamma((n_1+n_2)/2)}{\Gamma(n_1/2)\Gamma(n_2/2)}\cdot F^{(n_1-2)/2}\left(1+\frac{n_1}{n_2}F\right)^{-(n_1+n_2)/2}.
\]</div>
<p>This distribution is known by many names: Fisher-Snedecor distribution,
Fisher distribution, Snedecor distribution, variance ratio distribution,
and <span class="math notranslate nohighlight">\(F\)</span>-distribution. By convention, one usually puts the larger value
on top so that <span class="math notranslate nohighlight">\(F \ge 1\)</span>.<br />
The <span class="math notranslate nohighlight">\(F\)</span> distribution is used to test the statistical compatibility
between the variances of two different samples, which are obtained form
the same underlying distribution (more in <a class="reference external" href="./hypothesisTesting.html#f-test">Hypothesis testing</a>).</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">f</span>

<span class="n">params</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)]</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">limits</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">axf</span><span class="p">,</span> <span class="n">axF</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">fnfd</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
    <span class="n">fn</span><span class="p">,</span> <span class="n">fd</span> <span class="o">=</span> <span class="n">fnfd</span>
    <span class="n">frozen</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">dfn</span><span class="o">=</span><span class="n">fn</span><span class="p">,</span> <span class="n">dfd</span><span class="o">=</span><span class="n">fd</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">*</span><span class="n">limits</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
    <span class="n">fx</span> <span class="o">=</span> <span class="n">frozen</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">Fx</span> <span class="o">=</span> <span class="n">frozen</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fx</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$n_</span><span class="si">{</span><span class="mi">1</span><span class="si">}</span><span class="s2">$=</span><span class="si">{</span><span class="n">fn</span><span class="si">}</span><span class="s2">, $n_</span><span class="si">{</span><span class="mi">2</span><span class="si">}</span><span class="s2">$=</span><span class="si">{</span><span class="n">fd</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">axF</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Fx</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axF</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;f(x)&quot;</span><span class="p">)</span>
    <span class="n">axF</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;F(x)&quot;</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">limits</span><span class="p">)</span>
    <span class="n">axF</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">limits</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/probabilityDistributions_31_0.png" src="_images/probabilityDistributions_31_0.png" />
</div>
</div>
</div>
<div class="section" id="weibull-distribution">
<h3>Weibull Distribution<a class="headerlink" href="#weibull-distribution" title="Permalink to this headline">¶</a></h3>
<p>The Weibull distribution was originally invented to describe the rate of failures of light bulbs:</p>
<div class="math notranslate nohighlight">
\[
P(x;\alpha,\lambda)=\alpha\lambda(\lambda x)^{\alpha-1}e^{-(\lambda x)^{\alpha}}.
\]</div>
<p>with <span class="math notranslate nohighlight">\(x\ge 0\)</span> and <span class="math notranslate nohighlight">\(\alpha, \lambda &gt; 0\)</span>. The parameter <span class="math notranslate nohighlight">\(\alpha\)</span> is just
a scale factor and <span class="math notranslate nohighlight">\(\lambda\)</span> describes the width of the maximum. The
exponential distribution is a special case <span class="math notranslate nohighlight">\((\alpha = 1)\)</span>, when the
probability of failure at time t is independent of t. The Weibull
distribution is very useful to describe the reliability and to predict
failure rates. The expectation value of the Weibull distribution is
<span class="math notranslate nohighlight">\(\Gamma(\frac{1}{\alpha}+1) \frac{1}{\lambda}\)</span> and the variance is
<span class="math notranslate nohighlight">\(\frac{1}{\lambda^2} \left( \Gamma\left(\frac{2}{\alpha} +1\right) - \Gamma^2\left(\frac{1}{\alpha} +1\right) \right)\)</span>.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">weibull_min</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="n">params</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">limits</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">axf</span><span class="p">,</span> <span class="n">axF</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">al</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">l</span> <span class="o">=</span> <span class="n">al</span>
    <span class="n">frozen</span> <span class="o">=</span> <span class="n">weibull_min</span><span class="p">(</span><span class="n">c</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">l</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">*</span><span class="n">limits</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
    <span class="n">fx</span> <span class="o">=</span> <span class="n">frozen</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">Fx</span> <span class="o">=</span> <span class="n">frozen</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fx</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">alpha$=</span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s2">, $\lambda$=</span><span class="si">{</span><span class="n">l</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">axF</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Fx</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axF</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;f(x)&quot;</span><span class="p">)</span>
    <span class="n">axF</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;F(x)&quot;</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">limits</span><span class="p">)</span>
    <span class="n">axF</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">limits</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/probabilityDistributions_33_0.png" src="_images/probabilityDistributions_33_0.png" />
</div>
</div>
</div>
<div class="section" id="cauchy-breit-wigner-distribution">
<h3>Cauchy (Breit-Wigner) Distribution<a class="headerlink" href="#cauchy-breit-wigner-distribution" title="Permalink to this headline">¶</a></h3>
<p>The Cauchy probability density function is:</p>
<div class="math notranslate nohighlight">
\[
f(x)=\frac{1}{\pi}\frac{1}{1+x^2}.
\]</div>
<p>For large values of <span class="math notranslate nohighlight">\(x\)</span> it decreases only slowly. Neither the mean nor the variance are defined,
because the corresponding integrals are divergent. The particular Cauchy
distribution of the form</p>
<div class="math notranslate nohighlight">
\[
f(m;M,\Gamma)=\frac{1}{2\pi}\frac{\Gamma}{(m-M)^2+(\Gamma/2)^2}
\]</div>
<p>is also called Breit-Wigner function (see below), and is
used in particle physics to describe cross sections near a resonance
with mass <span class="math notranslate nohighlight">\(M\)</span> and width <span class="math notranslate nohighlight">\(\Gamma\)</span>. The Breit-Wigner comes as the
Fourier transformation of the wave function of an unstable particle:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Even if the mean does not exist, noting that the distribution is
symmetric, we can define it to be <span class="math notranslate nohighlight">\(M\)</span>; <span class="math notranslate nohighlight">\(\Gamma\)</span> is the FWHM. In
actual physical problems the distribution is truncated, e.g., by
energy conservation, and the resulting distribution is well-behaved.</p>
</div>
<div class="math notranslate nohighlight">
\[
\psi(t) \propto e^{-i E_i t /\hbar} e^{-\Gamma t /2}
\]</div>
<div class="math notranslate nohighlight">
\[
\phi(\omega)\propto \int_0^\infty \psi(t) e^{i \omega t} dt = \frac{i}{(\omega - \omega_0 + i \frac{\Gamma}{2}) }
\]</div>
<p>which squared gives:</p>
<div class="math notranslate nohighlight">
\[
|\phi(\omega)|^2 = \frac{1}{(\omega-\omega_0)^2 + \frac{\Gamma^2}{4}}.
\]</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">rv_continuous</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span>


<span class="k">class</span> <span class="nc">BreitWigner</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">G</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">bw</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">G</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">G</span> <span class="o">/</span> <span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">M</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">G</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

        <span class="n">norm</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">bw</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">G</span><span class="p">),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">bw</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">G</span><span class="p">)</span> <span class="o">/</span> <span class="n">norm</span>


<span class="n">breit_wigner</span> <span class="o">=</span> <span class="n">BreitWigner</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;breit_wigner&quot;</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="mi">91</span>
<span class="n">gammas</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">limits</span> <span class="o">=</span> <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mi">110</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="k">for</span> <span class="n">gamma</span> <span class="ow">in</span> <span class="n">gammas</span><span class="p">:</span>
    <span class="n">frozen</span> <span class="o">=</span> <span class="n">breit_wigner</span><span class="p">(</span><span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">G</span><span class="o">=</span><span class="n">gamma</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">*</span><span class="n">limits</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
    <span class="n">fx</span> <span class="o">=</span> <span class="n">frozen</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fx</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$m=m_{Z_</span><span class="si">{0}</span><span class="s2">}$,&quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot; $\Gamma$=</span><span class="si">{</span><span class="n">gamma</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;m&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;B-W(x)&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">limits</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/probabilityDistributions_35_0.png" src="_images/probabilityDistributions_35_0.png" />
</div>
</div>
</div>
<div class="section" id="landau-distribution">
<h3>Landau Distribution<a class="headerlink" href="#landau-distribution" title="Permalink to this headline">¶</a></h3>
<p>The Landau distribution (see <a class="reference internal" href="#fig-landau"><span class="std std-numref">Fig. 4</span></a>)
is used to describe the distribution of the energy loss <span class="math notranslate nohighlight">\(x\)</span>
(dimensionless quantity proportional to <span class="math notranslate nohighlight">\(dE\)</span>) of a charged particle (by
ionisation) passing through a thin layer of matter:</p>
<div class="math notranslate nohighlight">
\[
p(x) = \frac{1}{2\pi i} \int_{c-i\infty}^{c+i\infty} \exp(s\log s + xs)ds \qquad  (c &gt; 0).
\]</div>
<p>The long tail towards large energies models the large energy loss
fluctuations in thin layers. The mean and the variance of the
distribution are not defined.<br />
Often it can be found approximated as:</p>
<div class="math notranslate nohighlight">
\[
p(x) = \frac{1}{\sqrt{2\pi}}e^{-\frac{1}{2} \left( x+ e^{-x} \right) }
\]</div>
<div class="figure align-center" id="fig-landau">
<a class="reference internal image-reference" href="_images/landau.png"><img alt="_images/landau.png" src="_images/landau.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-number">Fig. 4 </span><span class="caption-text">FIXME: Straggling functions in silicon for 500 MeV pions, normalized to unity at the most probable value <span class="math notranslate nohighlight">\(\delta p/x\)</span>. The width <span class="math notranslate nohighlight">\(w\)</span> is the full width at half maximum. [PDGStatistics]</span><a class="headerlink" href="#fig-landau" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="crystal-ball">
<h3>Crystal Ball<a class="headerlink" href="#crystal-ball" title="Permalink to this headline">¶</a></h3>
<p>The Crystal Ball is typically used to describe the invariant mass
distribution of a resonance in which the decay products are affected by
energy losses. An example could be a <span class="math notranslate nohighlight">\(Z\to e^+ e^-\)</span> where the electrons
in the final state lose energy by brehmstralung. The distribution is
characterized by a Gaussian core with a power law tail</p>
<div class="math notranslate nohighlight">
\[\begin{split}
f(x) = N \cdot
\begin{cases}
    e^{-\frac{(x-\mu)^2}{2\sigma^2}} ,                    &amp; \text{if } \frac{x-\mu}{\sigma} &gt; -\alpha \\
    A \cdot \left( B - \frac{x-\mu}{\sigma}\right)^{-n},  &amp;  \text{if } \frac{x-\mu}{\sigma} \leq -\alpha
\end{cases}
\end{split}\]</div>
<p>where:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
 A &amp;=&amp; \left( \frac{n}{|\alpha|} \right)^n \cdot \exp\left( -\frac{|\alpha|^2}{2}\right)     \\
 B &amp;=&amp; \frac{n}{|\alpha|} - |\alpha|\end{aligned}
\end{split}\]</div>
<p>A trivial extension is given by the “Double Crystal Ball” where a second exponential tail is
added on the high side.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
f(x) = N \cdot
\begin{cases}
    e^{-\frac{(x-\mu)^2}{2\sigma^2}} ,                      &amp;  \text{if } \alpha_1 &lt; \frac{x-\mu}{\sigma} &lt; \alpha_2 \\
    A \cdot \left( B - \frac{x-\mu}{\sigma}\right)^{-n_1},  &amp;  \text{if } \frac{x-\mu}{\sigma} \leq \alpha_1\\
    C \cdot \left( D - \frac{x-\mu}{\sigma}\right)^{-n_2},  &amp;  \text{if } \frac{x-\mu}{\sigma} \geq \alpha_2
\end{cases}
\end{split}\]</div>
<p>where:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
 A &amp;=&amp; \left( \frac{n_1}{|\alpha_1|} \right)^{n_1} \cdot \exp\left( -\frac{|\alpha_1|^2}{2}\right)     \\
 B &amp;=&amp; \frac{n_1}{|\alpha_1|} - |\alpha_1| \\
 C &amp;=&amp; \left( \frac{n_2}{|\alpha_2|} \right)^{n_2} \cdot \exp\left( -\frac{|\alpha_2|^2}{2}\right)     \\
 D &amp;=&amp; \frac{n_2}{|\alpha_2|} - |\alpha_2|\end{aligned}
\end{split}\]</div>
<p>In case you are wondering, the name comes from the collaboration that first used
this function to describe a signal distribution. [&#64;crystalBall].</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">crystalball</span>

<span class="n">params</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">limits</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">axf</span><span class="p">,</span> <span class="n">axF</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
    <span class="n">alpha</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="n">group</span>
    <span class="n">frozen</span> <span class="o">=</span> <span class="n">crystalball</span><span class="p">(</span><span class="n">beta</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">m</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">*</span><span class="n">limits</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
    <span class="n">fx</span> <span class="o">=</span> <span class="n">frozen</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">Fx</span> <span class="o">=</span> <span class="n">frozen</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">x</span><span class="p">,</span>
        <span class="n">fx</span><span class="p">,</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">alpha$=</span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">, $n$=</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">, $m$=</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2">, $</span><span class="se">\\</span><span class="s2">sigma$=</span><span class="si">{</span><span class="n">sigma</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">axF</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Fx</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axF</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;f(x)&quot;</span><span class="p">)</span>
    <span class="n">axF</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;F(x)&quot;</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">limits</span><span class="p">)</span>
    <span class="n">axF</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">limits</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/probabilityDistributions_38_0.png" src="_images/probabilityDistributions_38_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="characteristic-function">
<h2>Characteristic Function<a class="headerlink" href="#characteristic-function" title="Permalink to this headline">¶</a></h2>
<p>The <em>characteristic function</em> <span class="math notranslate nohighlight">\(\Phi(t)\)</span> is defined as the expectation
value of <span class="math notranslate nohighlight">\(e^{itx}\)</span> for a p.d.f. <span class="math notranslate nohighlight">\(f(x)\)</span>:</p>
<div class="math notranslate nohighlight">
\[
\Phi(t):=&lt;e^{itx}&gt;=\int e^{itx}\cdot f(x)dx
\]</div>
<p>i.e <span class="math notranslate nohighlight">\(\Phi(t)\)</span> is the Fourier integral of f(x). The characteristic function completely
determines the p.d.f., since by inverting the Fourier transformation we
regain <span class="math notranslate nohighlight">\(f(x)\)</span>:</p>
<div class="math notranslate nohighlight">
\[
f(x)=\frac{1}{2\pi}\int e^{-itx}\cdot \Phi(t)dt
\]</div>
<p>The
characteristic function as well as its first and second derivative are
readily calculated for the special case where <span class="math notranslate nohighlight">\(t=0\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\Phi(0)&amp;=&amp;1 \\
\frac{d\Phi(0)}{dt}&amp;=&amp;i&lt;x&gt; \\
\frac{d^2\Phi(0)}{dt^2}&amp;=&amp;-(\sigma^2+&lt;x&gt;^2)
\end{aligned}
\end{split}\]</div>
<p>What do we
need characteristic functions for? They may be useful when performing
calculations with probability densities, for example if the convolution
of two probability densities <span class="math notranslate nohighlight">\(f_{1}\)</span> and <span class="math notranslate nohighlight">\(f_{2}\)</span> for two random
variables <span class="math notranslate nohighlight">\(x_{1}\)</span> and <span class="math notranslate nohighlight">\(x_{2}\)</span> should be calculated. A convolution of
<span class="math notranslate nohighlight">\(f_{1}\)</span> and <span class="math notranslate nohighlight">\(f_{2}\)</span> yields a new probability density <span class="math notranslate nohighlight">\(g(y)\)</span>, according
to which the sum of the random variable <span class="math notranslate nohighlight">\(y = x_{1} + x_{2}\)</span> is
distributed:</p>
<div class="math notranslate nohighlight">
\[
g(y)=\int \int f_1(x_1)f_2(x_2)\delta(y-x_1-x_2)dx_1dx_2=\int f_1(x_1)f_2(y-x_1)dx_1=\int f_2(x_2)f_1(y-x_2)dx_2
\]</div>
<p>The convolution integral can now be transformed with the help of the
characteristic functions:</p>
<div class="math notranslate nohighlight">
\[
\Phi_g(t)=\Phi_{f_1}(t)\cdot\Phi_{f_2}(t)
\]</div>
<p>In words: the characteristic function of the convolution of two
variables is obtained by the product of their characteristic functions.
Thus it can be easily shown that the convolution of two Gaussian
distributions with <span class="math notranslate nohighlight">\(\mu_{1,2}\)</span> and <span class="math notranslate nohighlight">\(\sigma_{1,2}\)</span> is again a Gaussian
distribution with <span class="math notranslate nohighlight">\(\mu = \mu_{1} + \mu_{2}\)</span> and
<span class="math notranslate nohighlight">\(\sigma^{2} = \sigma_{1}^{2} + \sigma_{2}^{2}\)</span>. Furthermore, the
convolution of two Poisson distributions is again a Poisson
distribution. The characteristic functions of some probability densities
are:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Distribution</p></th>
<th class="head"><p>Characteristic Function</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Binomial</p></td>
<td><p><span class="math notranslate nohighlight">\(\Phi(t)=(pe^{it}+q)^n\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Poisson</p></td>
<td><p><span class="math notranslate nohighlight">\(\Phi(t)=e^{\lambda(e^{it}-1)}\)</span></p></td>
</tr>
<tr class="row-even"><td><p>Gauss</p></td>
<td><p><span class="math notranslate nohighlight">\(\Phi(t)=e^{i\mu t-t^2\sigma^2/2}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\chi^2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\Phi(t)=(1-2it)^{-n/2}\)</span></p></td>
</tr>
<tr class="row-even"><td><p>Uniform (from a to b)</p></td>
<td><p><span class="math notranslate nohighlight">\(\Phi(t)=(e^{ibt}-e^{iat})/(b-a)^{it}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Breit-Wigner</p></td>
<td><p>$\Phi(t)=e^{-iE_0t-(\Gamma/2)</p></td>
</tr>
<tr class="row-even"><td><p>Gamma</p></td>
<td><p><span class="math notranslate nohighlight">\(\Phi(t)=(1-it/\mu)^{-\alpha}\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="the-central-limit-theorem">
<h2>The Central Limit Theorem<a class="headerlink" href="#the-central-limit-theorem" title="Permalink to this headline">¶</a></h2>
<p>The “Central Limit Theorem” (CLT) is probably the most important theorem
in statistics and it is the reason why the Gaussian distribution is so
important.<br />
Take <span class="math notranslate nohighlight">\(n\)</span> independent variables <span class="math notranslate nohighlight">\(x_i\)</span>, distributed according to p.d.f.’s
<span class="math notranslate nohighlight">\(f_i\)</span> having mean <span class="math notranslate nohighlight">\(\mu_i\)</span> and variance <span class="math notranslate nohighlight">\(\sigma_i^2\)</span>, then the p.d.f. of
the sum of the <span class="math notranslate nohighlight">\(x_i\)</span>, <span class="math notranslate nohighlight">\(S=\sum x_i\)</span>, has mean <span class="math notranslate nohighlight">\(\sum \mu_i\)</span> and variance
<span class="math notranslate nohighlight">\(\sum\sigma_i^2\)</span> and it approaches the normal p.d.f.
<span class="math notranslate nohighlight">\(N(S; \sum \mu_i, \sum \sigma_i^2)\)</span> as <span class="math notranslate nohighlight">\(n\to \infty\)</span>.<br />
The CLT holds under pretty general conditions:</p>
<ul>
<li><p>both mean and variance have to exist for each of the random
variables in the sum</p></li>
<li><p>Lindeberg criteria:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{aligned}
    y_k &amp;=&amp;  x_k,\quad {\rm if}\, |x_k-\mu_k|\le \epsilon_k\sigma_k \\
    y_k &amp;=&amp;   0,\quad {\rm if}\, |x_k-\mu_k|&gt; \epsilon_k\sigma_k.
    \end{aligned}
    \end{split}\]</div>
<p>Here, <span class="math notranslate nohighlight">\(\epsilon_{k}\)</span> is an arbitrary number.
If the variance <span class="math notranslate nohighlight">\((y_{1}+y_{2}+\cdots y_{n})/ \sigma_{y}^{2} \to 1\)</span> for
<span class="math notranslate nohighlight">\(n \to \infty\)</span>, then this condition is fulfilled for the CLT. In
plain English: The Lindeberg criteria ensures that fluctuations of a
single variable does not dominate its sum.</p>
</li>
</ul>
<p>An example of convergence for the CLT is given below where a
uniform distribution is used for 4 iterations.</p>
<p>When performing measurements the value obtained is usually affected by a
large number of (hopefully) small uncertainties. If this number of small
contributions is large the C.L.T. tells us that their total sum is
Gaussian distributed. This is often the case and is the reason
resolution functions are usually Gaussian. But if there are only a few
contributions, or if a few of the contributions are much larger than the
rest, the C.L.T. is not applicable, and the sum is not necessarily
Gaussian.</p>
<div class="tip admonition">
<p class="admonition-title">Example:</p>
<p>The inverse transverse momentum <span class="math notranslate nohighlight">\(q/p_T\)</span>, with q the charge of
the particle, can be deduced from the measured sagitta. <span class="math notranslate nohighlight">\(Q/p_T\)</span> has
Gaussian errors, not <span class="math notranslate nohighlight">\(p_T\)</span> !</p>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evts</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="n">limits</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">Ns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">*</span><span class="n">limits</span><span class="p">,</span> <span class="p">(</span><span class="n">evts</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Ns</span><span class="p">)))</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Ns</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">N</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Ns</span><span class="p">):</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sample</span><span class="p">[:,</span> <span class="p">:</span><span class="n">N</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;N=</span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">limits</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/probabilityDistributions_41_0.png" src="_images/probabilityDistributions_41_0.png" />
</div>
</div>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p>Pretty much every book about statistics/probability will cover the
material of this chapter. Here are a few examples:</p>
<ul class="simple">
<li><p>L. Lyons [&#64;Lyons], “Statistics for Nuclear and Particle Physicist”:
Ch. 3</p></li>
<li><p>W. Metzger [&#64;Metzger], “Statistical Methods in Data Analysis”: Ch.2</p></li>
<li><p>PDG [&#64;PDG], Probability</p></li>
<li><p>PDG [&#64;PDG], Passage of particles through matter</p></li>
</ul>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="probability.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Probability</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="errors.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Measurements uncertainties</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Mauro Donega<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>